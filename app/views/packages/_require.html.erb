<div class="row cs-require-panels cs-no-margin">

  <%
    dependency_relations = {
      "Requires" => @package.depending,
      "Used By" => @package.dependents
    }
  %>

  <% dependency_relations.each do |name, assocs| %>

    <div class="col-sm-6">

      <div class="panel panel-default cs-no-margin">

        <div class="panel-heading">

          <h4 class="cs-no-margin">
            <%= name %>:
          </h4>

        </div>

        <div class="panel-body cs-no-padding">

          <div class="list-group">

            <% if assocs.empty? %>

              <div class="list-group-item cs-no-padding">

                <div class="row-content cs-full-width cs-category-row">

                  <a class="btn btn-default cs-full-width cs-left-align cs-no-margin">
                    No Packages
                  </a>
                </div>

              </div>

            <% end %>

            <%

              assoc_list = assocs
                .includes(:counter)
                .order("counters.stargazer desc")
                .first(100)

            %>

            <% assoc_list.each_with_index do |package, index| %>

              <% unless index.zero? %>

                <div class="list-group-separator cs-full-width cs-no-margin"></div>

              <% end %>

              <div class="list-group-item cs-no-padding">

                <div class="row-content cs-full-width cs-category-row">

                  <%=
                    link_to package.name,
                      package_path(package),
                      class: "btn btn-default cs-full-width cs-left-align cs-no-margin #{ 'active' if current_page?(package_path(package)) }"
                  %>

                </div>

              </div>

            <% end %>

          </div>

        </div>

      </div>

    </div>

  <% end %>

</div>
